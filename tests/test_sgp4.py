#!/usr/bin/env python
# -*- coding: utf-8 -*-

from datetime import timedelta

from space.propagators.sgp4 import Sgp4
from space.orbits.tle import Tle


def test_one():

    test_cases = {
        """1 25544U 98067A   08264.51782528 -.00002182  00000-0 -11606-4 0  2927
        2 25544  51.6416 247.4627 0006703 130.5360 325.0288 15.72125391563537""":
            ([-3199119.301995459, -5925838.8951944616, -104283.8830105204],
             [4160.9001260609284, -2340.866691092328, 6034.2397874890221]),
        """1 27421U 02021A   15290.39156189  .00000174  00000-0  10000-3 0  9996
        2 27421  98.4973 341.4832 0001168 101.4896  26.7296 14.20902451697482""":
            ([-6313390.5470794961, 2392162.4266701206, -2518309.642217794],
             [2810.1811696039699, 188.82949370473077, -6882.7905710545047]),
        """1 38012U 11076F   15290.43560975 -.00001375  00000-0 -28626-3 0  9990
        2 38012  98.1856   3.4028 0001255  65.6426 294.5016 14.58534477204126""":
            ([-6278750.6667314125, -8651.4824499450478, -3277187.0595073523],
             [3419.2465632813287, 1208.7786614934842, -6564.4998427327491]),
        """1 25544U 98067A   15290.14517523  .00013306  00000-0  20592-3 0  9999
        2 25544  51.6447 195.3542 0006630  48.0978  95.2885 15.54379613967013""":
            ([-6596477.2658053795, 63108.245806544139, -1577202.6429110852],
             [-1410.6459948626079, -4877.7460063862936, 5746.8315844151521]),
    }

    for lines, expected in test_cases.items():
        tle = Tle(lines).orbit()

        sgp4 = Sgp4(tle)
        pv = sgp4.propagate(tle.epoch + timedelta(days=1))
        r, v = pv[:3], pv[3:]

        assert list(r) == expected[0]
        assert list(v) == expected[1]
