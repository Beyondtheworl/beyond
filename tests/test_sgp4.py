#!/usr/bin/env python
# -*- coding: utf-8 -*-

from datetime import timedelta

from space.propagators.sgp4 import SGP4
from space.orbits.tle import Tle

def test_one():

    test_cases = {
        """1 25544U 98067A   08264.51782528 -.00002182  00000-0 -11606-4 0  2927
        2 25544  51.6416 247.4627 0006703 130.5360 325.0288 15.72125391563537""":
            ([-3199.119301995459, -5925.8388951944617, -104.2838830105204],
             [4.1609001260609286, -2.3408666910923279, 6.0342397874890219]),
        """1 27421U 02021A   15290.39156189  .00000174  00000-0  10000-3 0  9996
        2 27421  98.4973 341.4832 0001168 101.4896  26.7296 14.20902451697482""":
            ([-6313.3905470794962, 2392.1624266701206, -2518.3096422177941],
             [2.81018116960397, 0.18882949370473076, -6.882790571054505]),
        """1 38012U 11076F   15290.43560975 -.00001375  00000-0 -28626-3 0  9990
        2 38012  98.1856   3.4028 0001255  65.6426 294.5016 14.58534477204126""":
            ([-6278.7506667314128, -8.651482449945048, -3277.1870595073524],
             [3.4192465632813285, 1.2087786614934841, -6.564499842732749]),
        """1 25544U 98067A   15290.14517523  .00013306  00000-0  20592-3 0  9999
        2 25544  51.6447 195.3542 0006630  48.0978  95.2885 15.54379613967013""":
            ([-6596.4772658053744, 63.108245806567496, -1577.2026429111124],
             [-1.410645994862648, -4.8777460063862934, 5.7468315844151414]),
    }

    for lines, expected in test_cases.items():
        tle = Tle(lines)

        sgp4 = SGP4(tle)
        r, v = sgp4.propagate(tle.epoch + timedelta(days=1))

        assert list(r) == expected[0]
        assert list(v) == expected[1]
